<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-06-26 Mon 18:06 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AFM / SPM Components</title>
<meta name="author" content="Nick Sullivan" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">AFM / SPM Components</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org0b23cf5">1. Overarching Diagram</a></li>
<li><a href="#org445ff07">2. Components</a>
<ul>
<li><a href="#orge6e14fe">2.1. Main Hardware</a>
<ul>
<li><a href="#org2fecc10">2.1.1. Cantilever Subsystem</a></li>
<li><a href="#org9495797">2.1.2. Scanning Subsystem</a></li>
</ul>
</li>
<li><a href="#orge75db63">2.2. Dynamic Mode Components</a>
<ul>
<li><a href="#org59b864f">2.2.1. Signal Generator</a></li>
<li><a href="#org523304e">2.2.2. Lock-In Amplifier</a></li>
</ul>
</li>
<li><a href="#org0a795d2">2.3. Feedback Subsystem</a>
<ul>
<li><a href="#orge15cf46">2.3.1. Multi-Source Setpoint Control</a></li>
<li><a href="#org4242d8e">2.3.2. PID Controller</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5a042ef">3. AFM / SPM Setups</a>
<ul>
<li><a href="#orgdc0d015">3.1. Contact Modes</a></li>
<li><a href="#org1c348e6">3.2. Dynamic Modes</a>
<ul>
<li><a href="#orge50323e">3.2.1. AM-AFM - Amplitude Modulation</a></li>
<li><a href="#org2605893">3.2.2. FM-AFM - Frequency Modulation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org033baf7">4. Full Table of Parameters</a></li>
</ul>
</div>
</div>

<div id="outline-container-org0b23cf5" class="outline-2">
<h2 id="org0b23cf5"><span class="section-number-2">1.</span> Overarching Diagram</h2>
<div class="outline-text-2" id="text-1">

<div id="org57b795c" class="figure">
<p><img src="images/afm_components.png" alt="afm_components.png" width="75%" />
</p>
</div>
</div>
</div>

<div id="outline-container-org445ff07" class="outline-2">
<h2 id="org445ff07"><span class="section-number-2">2.</span> Components</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orge6e14fe" class="outline-3">
<h3 id="orge6e14fe"><span class="section-number-3">2.1.</span> Main Hardware</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org2fecc10" class="outline-4">
<h4 id="org2fecc10"><span class="section-number-4">2.1.1.</span> Cantilever Subsystem</h4>
<div class="outline-text-4" id="text-2-1-1">
</div>
<div id="outline-container-orgaff78f6" class="outline-5">
<h5 id="orgaff78f6"><span class="section-number-5">2.1.1.1.</span> Diagram</h5>
<div class="outline-text-5" id="text-2-1-1-1">

<div id="org3a112a5" class="figure">
<p><img src="images/cantilever_subsystem.png" alt="cantilever_subsystem.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org8f6a418" class="outline-5">
<h5 id="org8f6a418"><span class="section-number-5">2.1.1.2.</span> Parameters</h5>
<div class="outline-text-5" id="text-2-1-1-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Grouping</th>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Cantilever</td>
<td class="org-left"><code>cantilever_invols</code></td>
<td class="org-left">Inverse Optical Lever Sensitivity</td>
<td class="org-left">m/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>cantilever_k</code></td>
<td class="org-left">Spring Constant</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>cantilever_f0</code></td>
<td class="org-left">Resonant Frequency</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>cantilever_q</code></td>
<td class="org-left">Q-Factor</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Tip-Surface</td>
<td class="org-left"><code>tip_bias_voltage</code></td>
<td class="org-left">Tip-Surface Bias Voltage</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>tip_bias_amp_gain</code></td>
<td class="org-left">Bias Amplifier Gain</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>tip_bias_amp_offset</code></td>
<td class="org-left">Bias Amplifier Offset</td>
<td class="org-left">V</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org9495797" class="outline-4">
<h4 id="org9495797"><span class="section-number-4">2.1.2.</span> Scanning Subsystem</h4>
<div class="outline-text-4" id="text-2-1-2">
</div>
<div id="outline-container-orgc2fd71e" class="outline-5">
<h5 id="orgc2fd71e"><span class="section-number-5">2.1.2.1.</span> Diagram</h5>
<div class="outline-text-5" id="text-2-1-2-1">

<div id="org0d12a0d" class="figure">
<p><img src="images/scanning_subsystem.png" alt="scanning_subsystem.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org76a4aa0" class="outline-5">
<h5 id="org76a4aa0"><span class="section-number-5">2.1.2.2.</span> Parameters</h5>
<div class="outline-text-5" id="text-2-1-2-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Grouping</th>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Piezo</td>
<td class="org-left"><code>piezo_sensitivity_{3d}</code></td>
<td class="org-left">Piezo Sensitivity</td>
<td class="org-left">Ang/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>piezo_amp_gain_{3d}</code></td>
<td class="org-left">Piezo Amplifier Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>piezo_amp_offset_{3d}</code></td>
<td class="org-left">Piezo Amplifier Offset/Bias</td>
<td class="org-left">V</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">LVDT</td>
<td class="org-left"><code>lvdt_sensitivity_{3d}</code></td>
<td class="org-left">LVDT Sensitivity</td>
<td class="org-left">V/Ang</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>lvdt_offset_{3d}</code></td>
<td class="org-left">LVDT Offset/Bias</td>
<td class="org-left">V</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Scan Params</td>
<td class="org-left"><code>scan_dim_{2d}</code></td>
<td class="org-left">Maximum Scan Dimensions</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_roi_dims_{2d}</code></td>
<td class="org-left">Current Scan Dimensions</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_roi_pos_{2d}</code></td>
<td class="org-left">Current Scan Offset (x,y)</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_origin_pos_{2d}</code></td>
<td class="org-left">Coordinate System Origin</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_roi_angle</code></td>
<td class="org-left">ROI Angle (if applicable)</td>
<td class="org-left">&deg;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_direction</code></td>
<td class="org-left">Scan Direction</td>
<td class="org-left">N/A</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scanning_speed</code></td>
<td class="org-left">Scanning Speed</td>
<td class="org-left">m/s</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>moving_speed</code></td>
<td class="org-left">Moving Speed (not scanning)</td>
<td class="org-left">m/s</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="outline-container-orge75db63" class="outline-3">
<h3 id="orge75db63"><span class="section-number-3">2.2.</span> Dynamic Mode Components</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org59b864f" class="outline-4">
<h4 id="org59b864f"><span class="section-number-4">2.2.1.</span> Signal Generator</h4>
<div class="outline-text-4" id="text-2-2-1">
</div>
<div id="outline-container-org63db60b" class="outline-5">
<h5 id="org63db60b"><span class="section-number-5">2.2.1.1.</span> Diagram</h5>
<div class="outline-text-5" id="text-2-2-1-1">

<div id="org16abda2" class="figure">
<p><img src="images/signal_generator.png" alt="signal_generator.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgc0efee8" class="outline-5">
<h5 id="orgc0efee8"><span class="section-number-5">2.2.1.2.</span> Parameters</h5>
<div class="outline-text-5" id="text-2-2-1-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Grouping</th>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Signal Generator</td>
<td class="org-left"><code>oscillator_f_ref</code></td>
<td class="org-left">Oscillator reference frequency</td>
<td class="org-left">Hz</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org523304e" class="outline-4">
<h4 id="org523304e"><span class="section-number-4">2.2.2.</span> Lock-In Amplifier</h4>
<div class="outline-text-4" id="text-2-2-2">
</div>
<div id="outline-container-org272ddf8" class="outline-5">
<h5 id="org272ddf8"><span class="section-number-5">2.2.2.1.</span> Diagram</h5>
<div class="outline-text-5" id="text-2-2-2-1">

<div id="orgaced830" class="figure">
<p><img src="images/lockin.png" alt="lockin.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org4b83a41" class="outline-5">
<h5 id="org4b83a41"><span class="section-number-5">2.2.2.2.</span> Parameters</h5>
<div class="outline-text-5" id="text-2-2-2-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Grouping</th>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Lock-In</td>
<td class="org-left"><code>lockin_averaging_period</code></td>
<td class="org-left">Averaging Period</td>
<td class="org-left">cycles</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>

<div id="outline-container-org0a795d2" class="outline-3">
<h3 id="org0a795d2"><span class="section-number-3">2.3.</span> Feedback Subsystem</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orge15cf46" class="outline-4">
<h4 id="orge15cf46"><span class="section-number-4">2.3.1.</span> Multi-Source Setpoint Control</h4>
<div class="outline-text-4" id="text-2-3-1">
</div>
<div id="outline-container-orgd7c8166" class="outline-5">
<h5 id="orgd7c8166"><span class="section-number-5">2.3.1.1.</span> Diagram</h5>
<div class="outline-text-5" id="text-2-3-1-1">

<div id="orgf7fca03" class="figure">
<p><img src="images/source_mixer.png" alt="source_mixer.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgcfe6f70" class="outline-5">
<h5 id="orgcfe6f70"><span class="section-number-5">2.3.1.2.</span> Parameters</h5>
<div class="outline-text-5" id="text-2-3-1-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Grouping</th>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Input</td>
<td class="org-left"><code>fb_input_{#}_units_to_v_factor</code></td>
<td class="org-left">Units-to-V conversion (Input represents x as DC V)</td>
<td class="org-left">x/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_gain</code></td>
<td class="org-left">Gi: gain applied to signal i (before summing)</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_setpoint</code></td>
<td class="org-left">Reference Set-Point</td>
<td class="org-left">V</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Low-Pass Filter</td>
<td class="org-left"><code>fb_input_{#}_low_pass_freq</code></td>
<td class="org-left">Cut-off Frequency</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_low_pass_adaptive_fmin</code></td>
<td class="org-left">Min. F0 (if adaptive)</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_low_pass_adaptive_fmax</code></td>
<td class="org-left">Max. F0 (if adaptive)</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_low_pass_adaptive_current</code></td>
<td class="org-left">Current Crossover (if adaptive)</td>
<td class="org-left">A</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Transform</td>
<td class="org-left"><code>fb_input_{#}_transform_mode</code></td>
<td class="org-left">Mode: 0:Off, 1:On, 2:Log, 4:IIR, 8:FUZZY</td>
<td class="org-left">n/a</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_transform_fuzzy_threshold</code></td>
<td class="org-left">Fuzzy-Mode Threshold Level (FUZZY Only)</td>
<td class="org-left">V</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org4242d8e" class="outline-4">
<h4 id="org4242d8e"><span class="section-number-4">2.3.2.</span> PID Controller</h4>
<div class="outline-text-4" id="text-2-3-2">
</div>
<div id="outline-container-org431b853" class="outline-5">
<h5 id="org431b853"><span class="section-number-5">2.3.2.1.</span> Diagram</h5>
<div class="outline-text-5" id="text-2-3-2-1">

<div id="orgadcc3ca" class="figure">
<p><img src="images/pid.png" alt="pid.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org46cdfd8" class="outline-5">
<h5 id="org46cdfd8"><span class="section-number-5">2.3.2.2.</span> Parameters</h5>
<div class="outline-text-5" id="text-2-3-2-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Grouping</th>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">PID</td>
<td class="org-left"><code>pid_gain_p</code></td>
<td class="org-left">Proportional Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pid_gain_i</code></td>
<td class="org-left">Integral Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pid_gain_d</code></td>
<td class="org-left">Derivative Gain</td>
<td class="org-left">V/V</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org5a042ef" class="outline-2">
<h2 id="org5a042ef"><span class="section-number-2">3.</span> AFM / SPM Setups</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgdc0d015" class="outline-3">
<h3 id="orgdc0d015"><span class="section-number-3">3.1.</span> Contact Modes</h3>
<div class="outline-text-3" id="text-3-1">

<div id="org3145b82" class="figure">
<p><img src="images/contact_mode.png" alt="contact_mode.png" />
</p>
</div>

<p>
Approach:
</p>

<p>
Scan over a region with a static tip, while maintaining a constant force on the tip. This is achieved by a feedback loop, where the z-height (i.e. cantilever deflection) is kept constant.
</p>
</div>
</div>

<div id="outline-container-org1c348e6" class="outline-3">
<h3 id="org1c348e6"><span class="section-number-3">3.2.</span> Dynamic Modes</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-orge50323e" class="outline-4">
<h4 id="orge50323e"><span class="section-number-4">3.2.1.</span> AM-AFM - Amplitude Modulation</h4>
<div class="outline-text-4" id="text-3-2-1">

<div id="org0d06c72" class="figure">
<p><img src="images/am-afm.png" alt="am-afm.png" width="75%" />
</p>
</div>

<p>
Approach:
</p>

<p>
Scan over a region with the tip oscillating its z-height at its resonant frequency, while maintaining the oscillation amplitude constant. This is achieved by a feedback loop, where the z-height is changed whenever the oscillation amplitude difference between the excitation signal amplitude and resonator signal amplitude varies from a desired difference.
</p>

<p>
Notes:
</p>
<ul class="org-ul">
<li>The change in amplitude is due to a change in the system&rsquo;s resonant frequency. You can visualize this as if the amplitude/frequency curve is translating along the frequency axis. Doing so decreases the amplitude; we modify the z-height so that the system&rsquo;s resonant frequency is returned to its initial state (where the amplitude is maximum).</li>
</ul>
</div>
</div>

<div id="outline-container-org2605893" class="outline-4">
<h4 id="org2605893"><span class="section-number-4">3.2.2.</span> FM-AFM - Frequency Modulation</h4>
<div class="outline-text-4" id="text-3-2-2">

<div id="org7892c6b" class="figure">
<p><img src="images/fm-afm.png" alt="fm-afm.png" width="85%" />
</p>
</div>

<p>
Approach:
</p>

<p>
Scan over a region with the tip oscillating its z-height at its resonant frequency, while maintaining the resonant frequency constant. This requires 3 different feedback loops:
</p>
<ul class="org-ul">
<li>The z-height feedback loop, where the z-height is changed whenever the frequency difference between excitation signal frequency and resonator signal frequency varies from a desired difference.</li>
<li>The phased lock loop component, where the excitation signal phase is changed whenever the phase difference between excitation signal phase and resonator signal phase varies from a desired difference. Since phase and frequency are intricately linked (instantaneous frequency is temporal rate of change of instantaneous phase), maintaining the phase ensures we maintain the frequency. Thus, this feedback ensures that <b>as the system resonant frequency changes</b>, we update the <b>excitation signal</b> to keep driving the system <b>on resonance</b> (i.e. the resonant signal frequency is always at the system&rsquo;s current resonant frequency).</li>
<li>Traditionally, there is also an amplitude feedback loop, which ensures that the amplitude of resonance is kept constant.</li>
</ul>

<p>
Notes:
</p>
<ul class="org-ul">
<li>We require the PLL <b>and</b> z-height feedback because they function at different frequencies: PLL at ~100 kHz, z-height at ~1 kHz.</li>
<li>So: the PLL maintains the signal on resonance <b>much more quickly</b> than the z-height maintains the resonant frequency constant.</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org033baf7" class="outline-2">
<h2 id="org033baf7"><span class="section-number-2">4.</span> Full Table of Parameters</h2>
<div class="outline-text-2" id="text-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Subsystem</th>
<th scope="col" class="org-left">Grouping</th>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Cantilever</td>
<td class="org-left">Cantilever</td>
<td class="org-left"><code>cantilever_invols</code></td>
<td class="org-left">Inverse Optical Lever Sensitivity</td>
<td class="org-left">m/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>cantilever_k</code></td>
<td class="org-left">Spring Constant</td>
<td class="org-left">n/a</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>cantilever_f0</code></td>
<td class="org-left">Resonant Frequency</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>cantilever_q</code></td>
<td class="org-left">Q-Factor</td>
<td class="org-left">n/</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Tip-Surface</td>
<td class="org-left"><code>tip_bias_voltage</code></td>
<td class="org-left">Tip-Surface Bias Voltage</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>tip_bias_amp_gain</code></td>
<td class="org-left">Bias Amplifier Gain</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>tip_bias_amp_offset</code></td>
<td class="org-left">Bias Amplifier Offset</td>
<td class="org-left">V</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Scanning</td>
<td class="org-left">Piezo</td>
<td class="org-left"><code>piezo_sensitivity_{3d}</code></td>
<td class="org-left">Piezo Sensitivity</td>
<td class="org-left">Ang/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>piezo_amp_gain_{3d}</code></td>
<td class="org-left">Piezo Amplifier Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>piezo_amp_offset_{3d}</code></td>
<td class="org-left">Piezo Amplifier Offset/Bias</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">LVDT</td>
<td class="org-left"><code>lvdt_sensitivity_{3d}</code></td>
<td class="org-left">LVDT Sensitivity</td>
<td class="org-left">V/Ang</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>lvdt_offset_{3d}</code></td>
<td class="org-left">LVDT Offset/Bias</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Scan Params</td>
<td class="org-left"><code>scan_dim_{2d}</code></td>
<td class="org-left">Maximum Scan Dimensions</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_roi_dims_{2d}</code></td>
<td class="org-left">Current Scan Dimensions</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_roi_pos_{2d}</code></td>
<td class="org-left">Current Scan Offset (x,y)</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_origin_pos_{2d}</code></td>
<td class="org-left">Coordinate System Origin</td>
<td class="org-left">m</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_roi_angle</code></td>
<td class="org-left">ROI Angle (if applicable)</td>
<td class="org-left">&deg;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scan_direction</code></td>
<td class="org-left">Scan Direction</td>
<td class="org-left">N/A</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>scanning_speed</code></td>
<td class="org-left">Scanning Speed</td>
<td class="org-left">m/s</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>moving_speed</code></td>
<td class="org-left">Moving Speed (not scanning)</td>
<td class="org-left">m/s</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Main Feedback</td>
<td class="org-left">Input</td>
<td class="org-left"><code>fb_input_{#}_units_to_v_factor</code></td>
<td class="org-left">Units-to-V conversion (Input represents x as DC V)</td>
<td class="org-left">x/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_gain</code></td>
<td class="org-left">Gi: gain applied to signal i (before summing)</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_setpoint</code></td>
<td class="org-left">Reference Set-Point</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Low-Pass Filter</td>
<td class="org-left"><code>fb_input_{#}_low_pass_freq</code></td>
<td class="org-left">Cut-off Frequency</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_low_pass_adaptive_fmin</code></td>
<td class="org-left">Min. F0 (if adaptive)</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_low_pass_adaptive_fmax</code></td>
<td class="org-left">Max. F0 (if adaptive)</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_{#}_low_pass_adaptive_current</code></td>
<td class="org-left">Current Crossover (if adaptive)</td>
<td class="org-left">A</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Transform</td>
<td class="org-left"><code>fb_input_transform_mode</code></td>
<td class="org-left">Mode: 0:Off, 1:On, 2:Log, 4:IIR, 8:FUZZY</td>
<td class="org-left">n/a</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_input_transform_fuzzy_threshold</code></td>
<td class="org-left">Fuzzy-Mode Threshold Level (FUZZY Only)</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">PID</td>
<td class="org-left"><code>fb_pid_gain_p</code></td>
<td class="org-left">Proportional Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_pid_gain_i</code></td>
<td class="org-left">Integral Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>fb_pid_gain_d</code></td>
<td class="org-left">Derivative Gain</td>
<td class="org-left">V/V</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Dynamic Mode</td>
<td class="org-left">Signal Generator</td>
<td class="org-left"><code>oscillator_f_ref</code></td>
<td class="org-left">Oscillator reference frequency</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Lock-In</td>
<td class="org-left"><code>lockin_averaging_period</code></td>
<td class="org-left">Averaging Period</td>
<td class="org-left">cycles</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Amplitude Feedback</td>
<td class="org-left"><code>amp_fb_enabled</code></td>
<td class="org-left">On/Off</td>
<td class="org-left">n/a</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>amp_fb_input_v_to_v_factor</code></td>
<td class="org-left">V-to-V conversion (represents V-amplitude as DC V)</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>amp_fb_input_gain</code></td>
<td class="org-left">Gain applied to signal i</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>amp_fb_input_setpoint</code></td>
<td class="org-left">dAmplitude Set-Point</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>amp_fb_low_pass_freq</code></td>
<td class="org-left">Cut-off Frequency</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>amp_fb_pid_gain_p</code></td>
<td class="org-left">Proportional Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>amp_fb_pid_gain_i</code></td>
<td class="org-left">Integral Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>amp_fb_pid_gain_d</code></td>
<td class="org-left">Derivative Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Phase Feedback</td>
<td class="org-left"><code>pll_fb_enabled</code></td>
<td class="org-left">On/Off</td>
<td class="org-left">n/a</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pll_fb_input_hz_to_v_factor</code></td>
<td class="org-left">dHz-to-V conversion (represents Hz as DC V)</td>
<td class="org-left">Hz/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pll_fb_input_gain</code></td>
<td class="org-left">Gain applied to signal i</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pll_fb_input_setpoint</code></td>
<td class="org-left">dFrequency Set-Point</td>
<td class="org-left">V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pll_fb_low_pass_freq</code></td>
<td class="org-left">Cut-off Frequency</td>
<td class="org-left">Hz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pll_fb_pid_gain_p</code></td>
<td class="org-left">Proportional Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pll_fb_pid_gain_i</code></td>
<td class="org-left">Integral Gain</td>
<td class="org-left">V/V</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pll_fb_pid_gain_d</code></td>
<td class="org-left">Derivative Gain</td>
<td class="org-left">V/V</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Nick Sullivan</p>
<p class="date">Created: 2023-06-26 Mon 18:06</p>
</div>
</body>
</html>